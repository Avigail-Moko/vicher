<div style="text-align: center">
  <h1 class="text-6xl quattrocento-sans-regular line-height-1">
    Welcome to Vicher!
  </h1>
  <h2 class="text-3xl quattrocento-sans-regular">
    Find the <span class="merinada">virtual teacher</span> for you
  </h2>
</div>
<p-toolbar class="flex justify-content-center flex-wrap mt-6">
  <span class="flex-grow-1 mx-2 span">
    <div class="p-float-label">
      <p-autoComplete
        class="searchBox"
        inputId="searchLabel"
        [(ngModel)]="selectedObject"
        [suggestions]="filteredObjects"
        (completeMethod)="filterObject($event)"
        [field]="usersFlag ? 'name' : 'lesson_title'"
        (onSelect)="onObjectSelect($event)"
        (ngModelChange)="onTextChange($event)"
      >
      </p-autoComplete>
      <label for="searchLabel">
        <i class="pi pi-search mx-2 text-400"></i>
        <span class="text-400 vertical-align-text-top">{{ searchLabel }}</span>
      </label>
    </div>
    <mat-chip-listbox
      aria-label="Sort option"
      class="p-grid align-items-center justify-content-around pt-2"
    >
      <mat-chip-option
        color="primary"
        class="m-1"
        selected
        (click)="getAllUsers()"
        >Users</mat-chip-option
      >
      <mat-chip-option color="primary" class="m-1" (click)="getAllProducts()"
        >Products</mat-chip-option
      >
    </mat-chip-listbox>
  </span>
  <div
    *ngIf="!usersFlag"
    class="p-grid align-items-center justify-content-center button-container ml-5"
  >
    <h2 class="oswald-sharp">Most Popular Categories</h2>
    <button
      *ngFor="let category of filteredCategories"
      pButton
      type="button"
      class="col-4 m-1"
    >
      {{ category.name }}
    </button>
  </div>
</p-toolbar>

<div class="card" *ngIf="!usersFlag">
  <ng-container *ngIf="products">
    <div class="cards-container">
      <mat-card
        class="product-card m-2"
        *ngFor="
          let product of products
            | paginate : { itemsPerPage: 10, currentPage: p }
        "
        (click)="openDailyPlanner(product)"
      >
        <mat-card-header class="flex flex-column p-0">
          <img
            class="header-image"
            [src]="product.image.src"
            width="250px"
            alt="{{ product.image.filename }}"
          />
          <div class="flex px-2">
            <div
              mat-card-avatar
              class="content-image"
              [style.background-image]="'url(' + product.userProfileImage + ')'"
            ></div>
            <mat-card-title class="text-sm ml-2 font-italic">
              <span class="text-400">Ad by</span>
              {{ product.userProfileName }}
            </mat-card-title>
          </div>
        </mat-card-header>
        <mat-card-content class="p-3">
          <mat-card-title>{{ product.lesson_title }}</mat-card-title>
          <div class="flex flex-row justify-content-between">
            <mat-card-subtitle>
              <i class="pi pi-tag text-sm"></i>
              {{ product.category }}
            </mat-card-subtitle>
            <span class="font-bold text-100">{{
              "â‚ª" + " " + product.price
            }}</span>
          </div>
          <mat-card-subtitle>
            lesson length: {{ product.length }} min.
          </mat-card-subtitle>
        </mat-card-content>
        <mat-card-footer class="px-3 product-footer">
          <p class="description">
            {{ product.description }}
          </p>
        </mat-card-footer>
      </mat-card>
      <pagination-controls (pageChange)="p = $event"></pagination-controls>
    </div>
  </ng-container>
</div>

<div class="card" *ngIf="usersFlag">
  <ng-container *ngIf="objects">
    <div class="cards-container">
      <mat-card
        class="product-card m-2"
        *ngFor="
          let user of filteredObjects
            ? filteredObjects
            : (objects | paginate : { itemsPerPage: 10, currentPage: p })
        "
        (click)="openUserView(user)"
      >
        <mat-card-header class="flex flex-column p-2">
          <div
            class="header-image"
            [style.background-image]="'url(' + user.profileImage + ')'"
            width="250px"
          ></div>
        </mat-card-header>
        <mat-card-content class="p-3">
          <p class="overflow-hidden text-overflow-ellipsis">
            {{ user.name }}
          </p>
          <p-rating
            class="p-rating mb-3"
            [(ngModel)]="user.avgRating"
            [readonly]="true"
            [cancel]="false"
            [attr.data-rater-counter]="user.raterCounter"
          ></p-rating>

          <mat-card-title class="text-sm">
            {{ user.email }}
          </mat-card-title>
        </mat-card-content>
        <mat-card-footer class="px-3 product-footer">
          <p *ngIf="!user.description" class="text-400">
            The user has not yet provided a personal description.
          </p>
          <p class="description">{{ user.description }}</p>
        </mat-card-footer>
      </mat-card>
      <pagination-controls (pageChange)="p = $event"></pagination-controls>
    </div>
  </ng-container>
</div>
<div class="card">
  <p-toast [life]="5000"></p-toast>
</div>
